<div>
  <table class="table-responsive table-bordered">
    <thead table-header [configurations]="configurations"></thead>
    <tbody>
    <ng-container *ngIf="!tableData.groupData">
        <tr *ngFor="let row of tableData.data; let rowIndex = index; trackBy: trackByIndex">
            <td *ngFor="let data of row; let colIndex = index; trackBy: trackByIndex"
                table-cell
                #cell
                [rowSpan]="cell['rowspan']"
                [column]="colIndex"
                [row]="rowIndex"
                [columnWord]="words[colIndex]"
                [wordAddress]="words[colIndex] + '.' + rowIndex"
                [descriptor]="configurations.states.columns[colIndex]">
            </td>
        </tr>
    </ng-container>
    <ng-container *ngIf="tableData.groupData">
      <ng-container *ngTemplateOutlet="groupTemplate; context: { rowGroups: tableData.groupData }"></ng-container>
    </ng-container>
    </tbody>
  </table>
</div>

<ng-template #groupTemplate let-rowGroups="rowGroups" let-parentIndex="parentIndex" let-parentText="parentText">
  <ng-container *ngFor="let group of rowGroups; let groupIndex = index">
    <tr>
      <td>{{ group.indexFn(groupIndex, { parentIndex: parentIndex, parentText: parentText }) }}</td>
      <ng-container *ngFor="let col of configurations.states.columns; let colIndex = index">
        <td>{{ colIndex === 0 ? group.name : '' }}</td>
      </ng-container>
    </tr>
    <ng-container *ngIf="group.data">
      <tr *ngFor="let row of group.data; let rowIndex = index; trackBy: trackByIndex">
        <td>
          {{ getRowIndex(rowIndex, {
              parentIndex: groupIndex,
              parentText: group.indexFn(groupIndex, { parentIndex: parentIndex, parentText: parentText })
            })
          }}
        </td>
        <td *ngFor="let data of row; let colIndex = index; trackBy: trackByIndex"
            table-cell
            #cell
            [column]="colIndex"
            [row]="rowIndex"
            [group]="group"
            [columnWord]="words[colIndex]"
            [wordAddress]="words[colIndex] + '.' + rowIndex"
            [descriptor]="configurations.states.columns[colIndex]">
        </td>
      </tr>
    </ng-container>
    <ng-container *ngIf="group.subGroups">
      <ng-container *ngTemplateOutlet="groupTemplate; context: {
        rowGroups: group.subGroups,
        parentIndex: groupIndex,
        parentText: group.indexFn(groupIndex, { parentIndex: parentIndex, parentText: parentText })
      }"></ng-container>
    </ng-container>
  </ng-container>
</ng-template>